(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{215:function(e,t,a){e.exports=a(404)},220:function(e,t,a){},222:function(e,t,a){},404:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(22),o=a.n(s),i=(a(220),a(14)),l=a(15),c=a(18),u=a(16),p=a(17),m=(a(222),a(150)),d=a(19),h=a.n(d),f=a(30),v=a(43),g=a(33),b=a.n(g),E={GET_MODULE:"/api/model",GET_INPUTS:"/api/inputs",PUT_INPUTS:"/api/inputs",GET_VISUALISATIONS:"/api/visualisation",PUT_VISUALISATIONS:"/api/visualisation",getModuleLayerOutput:function(e){return"/api/model/layer/output/".concat(e)}},y=(a(247),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={tree:null,visualisations:[],currentVisualisation:{},isLoading:!1,open:!1,outputs:[],layer:{name:""},last:0,next:!1,settings:{size:50},inputs:[],currentInput:0},a.toogleDrawer=Object(f.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({open:!a.state.open});case 2:case"end":return e.stop()}},e,this)})),a.getLayerOutputs=Object(f.a)(h.a.mark(function e(){var t,n,r,s,o,i,l=arguments;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:a.state.layer,n=l.length>1&&void 0!==l[1]&&l[1],!a.state.isLoading){e.next=5;break}return console.log("Loading"),e.abrupt("return");case 5:return r=t.id==a.state.layer.id,n&&(r=!1),s=r?a.state.last+64:0,e.prev=8,e.next=11,a.setState({isLoading:!0});case 11:return e.next=13,b.a.get(E.getModuleLayerOutput(t.id,s),{params:{last:s}});case 13:return o=e.sent,i=r?a.state.outputs.concat(o.data.links):o.data.links,e.next=17,a.setState({outputs:i,layer:t,last:s,isLoading:!1,next:o.data.next});case 17:e.next=23;break;case 19:return e.prev=19,e.t0=e.catch(8),e.next=23,a.setState({isLoading:!1});case 23:case"end":return e.stop()}},e,this,[[8,19]])})),a.changeSettings=function(){var e=Object(f.a)(h.a.mark(function e(t){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({settings:t});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getTree",value:function(){var e=Object(f.a)(h.a.mark(function e(){var t,a;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({isLoading:!0});case 2:return e.next=4,b.a.get(E.GET_MODULE);case 4:return t=e.sent,a=t.data,e.next=8,this.setState({tree:a,isLoading:!1});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getVisualisations",value:function(){var e=Object(f.a)(h.a.mark(function e(){var t,a,n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.isLoading){e.next=3;break}return console.log("Loading"),e.abrupt("return");case 3:return e.next=5,this.setState({isLoading:!0});case 5:return e.next=7,b.a.get(E.GET_VISUALISATIONS);case 7:return t=e.sent,a=t.data.visualisations,n=t.data.current,e.next=12,this.setState({visualisations:a,isLoading:!1,currentVisualisation:n});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setVisualisationsSettings",value:function(){var e=Object(f.a)(h.a.mark(function e(t){var a,n,r,s;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.isLoading){e.next=3;break}return console.log("Loading"),e.abrupt("return");case 3:return e.next=5,this.setState({isLoading:!0});case 5:return e.next=7,b.a.put(E.PUT_VISUALISATIONS,t);case 7:for(s in a=e.sent,n=a.data,r=Object(m.a)(this.state.visualisations))r[s].name==n.name&&(r[s]=n);return e.next=13,this.setState({isLoading:!1,currentVisualisation:n,visualisations:r});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getInputs",value:function(){var e=Object(f.a)(h.a.mark(function e(){var t;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get(E.GET_INPUTS);case 2:return t=e.sent,e.next=5,this.setState({inputs:t.data.links});case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setInput",value:function(){var e=Object(f.a)(h.a.mark(function e(t){var a,n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.put(E.PUT_INPUTS,{id:t});case 2:return a=e.sent,e.next=5,this.getLayerOutputs(this.state.layer,!0);case 5:return n=a.data.id,e.next=8,this.setState({currentInput:n});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}(v.a)),O=a(23),j=a.n(O),w=a(24),x=a.n(w),k=a(27),S=a.n(k),L=a(70),I=a.n(L),C=a(146),N=a.n(C),T=a(147),A=a.n(T),U=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={open:!1},a.getMoreOnScrollBottom=function(){var e=a.props.module.state.layerId==a.props.layer.id;window.scrollY==window.scrollMaxY&&e&&!a.props.module.state.isLoading&&a.props.module.getLayerOutputs(a.props.layer.id)},a.handleClick=function(e){a.setState(function(e){return{open:!e.open}}),a.props.module.getLayerOutputs(e)},a.renderLayer=function(e){var n=a.props.layer.name.split("(")[0];return r.a.createElement(j.a,null,r.a.createElement(x.a,{button:!0,onClick:function(){return a.handleClick(a.props.layer)}},r.a.createElement(S.a,{primary:n}),a.state.open?r.a.createElement(N.a,null):r.a.createElement(A.a,null)),r.a.createElement(I.a,{in:a.state.open,timeout:"auto",unmountOnExit:!0},e.children.map(function(e,n){return r.a.createElement(t,{layer:e,module:a.props.module,key:n,deepth:a.props.deepth+1})})))},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.getMoreOnScrollBottom)}},{key:"componentWillUnmount",value:function(){window.addEventListener("scroll",this.getMoreOnScrollBottom)}},{key:"render",value:function(){var e=this.props.layer;return r.a.createElement(j.a,{style:{marginLeft:8*this.props.deepth/2}},e?this.renderLayer(e):r.a.createElement(x.a,null))}}]),t}(n.Component),V=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.module.getTree()}},{key:"render",value:function(){var e=this.props.module.state.tree;return r.a.createElement(j.a,null,r.a.createElement(U,{layer:e,module:this.props.module,deepth:1}))}}]),t}(n.Component),M=a(29),B=a(42),P=a.n(B),D=a(78),_=a.n(D),z=a(57),G=a.n(z),W=a(108),Y=a(41),J=a.n(Y),H=a(71),$=a.n(H),q=a(72),F=a.n(q),K=a(73),Q=a.n(K),R=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={anchorEl:null},a.handleMenuClick=function(e){a.setState({anchorEl:e.currentTarget})},a.handleClose=function(e,t){a.setState({anchorEl:null}),a.update(Object(M.a)({},e,{value:t}))},a.update=function(e){var t=Object(M.a)({},a.props.param,e),n={};n[a.props.name]=t,a.props.update(n)},a.makeParam=function(e){if("slider"==e.type){var t=e.max,n=e.min,s=e.step,o=e.value;return r.a.createElement(S.a,null,r.a.createElement("div",null,a.props.name+" : "+o),r.a.createElement("div",{className:a.props.classes.sliders},r.a.createElement(_.a,{value:o,"aria-labelledby":"label",min:n,max:t,step:s,onChange:Object(W.a)(300,function(t,n){return a.update(Object(M.a)({},e,{value:n}))})})))}if("radio"==e.type)return r.a.createElement(S.a,null,r.a.createElement("div",null,a.props.name,r.a.createElement(G.a,{checked:e.value,onClick:function(t,n){return a.update(Object(M.a)({},e,{value:!e.value}))},value:"a",name:"radio-button-demo","aria-label":"A"})));if("menu"==e.type){var i=e.items,l=(o=e.value,a.state.anchorEl);return r.a.createElement(S.a,null,r.a.createElement("div",null,a.props.name,r.a.createElement(J.a,{"aria-owns":l?"".concat(a.props.name,"-menu"):void 0,"aria-haspopup":"true",onClick:a.handleMenuClick},o),r.a.createElement($.a,{id:"".concat(a.props.name,"-menu"),anchorEl:l,open:Boolean(l),onClose:a.handleClose},i.map(function(t){return r.a.createElement(F.a,{onClick:function(){return a.handleClose(e,t)}},t)}))))}return"textfield"==e.type?r.a.createElement(S.a,null,r.a.createElement(Q.a,{label:e.label,value:a.state.name,onChange:function(t){return Object(W.a)(300,a.update(Object(M.a)({},e,{value:t.target.value})))},margin:"normal"})):void 0},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.classes,e.module,e.param);e.name,t.params;return r.a.createElement(j.a,null,r.a.createElement(x.a,null,this.makeParam(t)),r.a.createElement(x.a,null))}}]),t}(n.Component),X=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).update=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(console.log("from down",e),t){var n=Object(M.a)({},a.props.visualisation.params,e);n=Object(M.a)({},a.props.visualisation,{params:n})}else n=Object(M.a)({},a.props.visualisation,e);console.log(n),a.props.module.setVisualisationsSettings(n),a.props.module.getLayerOutputs(a.props.module.state.layer,!0)},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=(t.module,t.visualisation),n=a.name,s=a.params;return r.a.createElement(j.a,null,r.a.createElement(x.a,null,r.a.createElement(S.a,null,r.a.createElement("div",null,n)),r.a.createElement(G.a,{checked:this.props.module.state.currentVisualisation.name==n,onChange:function(t,n){return e.update(Object(M.a)({},a,{value:n}),!1)},value:"a",name:"radio-button-demo","aria-label":"A"})),Object.keys(s).map(function(t,a){return r.a.createElement(R,Object.assign({},e.props,{name:t,param:s[t],update:e.update,key:a}))}))}}]),t}(n.Component),Z=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onVisualisationSettingsChange=function(e){a.props.module.setVisualisationsSettings(e)},a.handleSlider=function(e,t){var n=a.props.module,r=n.state.settings;r=Object.assign({},r,{size:t}),n.changeSettings(r)},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.module.getVisualisations()}},{key:"render",value:function(){var e=this,t=this.props,a=t.toogle,n=t.classes,s=t.open,o=t.module,i=t.small,l=void 0!==i&&i;return r.a.createElement(P.a,{anchor:"right",variant:l?"temporary":"permanent",open:s,className:n.drawer,onClose:a,classes:{paper:n.drawerPaper}},r.a.createElement("div",{className:n.toolbar}),r.a.createElement(j.a,{className:n.settings},r.a.createElement(x.a,null,r.a.createElement(S.a,null,"Image size : ",o.state.settings.size)),r.a.createElement(x.a,null,r.a.createElement(_.a,{value:o.state.settings.size,"aria-labelledby":"label",min:1,max:100,step:1,onChange:this.handleSlider}))),r.a.createElement(j.a,{className:n.settings},r.a.createElement(x.a,null,r.a.createElement(S.a,null,r.a.createElement("div",null,"Visualisations"),this.props.module.state.visualisations.map(function(t,a){return r.a.createElement(X,Object.assign({key:a},e.props,{visualisation:t,update:e.onVisualisationSettingsChange}))})))))}}]),t}(n.Component),ee=a(74),te=a.n(ee),ae=a(56),ne=a.n(ae),re=a(32),se=a.n(re),oe=a(75),ie=a.n(oe),le=a(20),ce=a(76),ue=a.n(ce),pe=a(58),me=a(26),de=a.n(me),he=(n.Component,function(e){var t=e.src,a=e.size,n={height:"".concat(a/10*100,"px"),width:"".concat(a/10*100,"px")};return r.a.createElement(de.a,{item:!0},r.a.createElement("img",{src:t,style:n}))}),fe=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.module;e.classes;return r.a.createElement("div",null,r.a.createElement(de.a,{container:!0,direction:"row",justify:"center",alignItems:"center",spacing:8},r.a.createElement(de.a,{item:!0,xs:12},r.a.createElement(se.a,{variant:"h6",gutterBottom:!0,style:{textAlign:"center"}},t.state.layer.name.split("(")[0])),t.state.outputs.map(function(e,a){return r.a.createElement(he,Object.assign({src:e},t.state.settings,{key:a}))})),r.a.createElement(de.a,{container:!0,direction:"row",justify:"center",alignItems:"center",spacing:8},r.a.createElement(de.a,{item:!0},0==this.props.module.state.outputs.length?r.a.createElement("h1",null,"Nothing to show"):this.props.module.state.next?r.a.createElement(J.a,{variant:"contained",color:"primary",onClick:function(){return t.getLayerOutputs()}},"More"):"")))}}]),t}(r.a.Component),ve=a(149),ge=a.n(ve),be=a(44),Ee=a.n(be),ye=a(77),Oe=a(5),je=a.n(Oe),we=a(148),xe=function(e){var t=e.module,a=e.id,n=e.src,s=e.classes,o=a==t.state.currentInput;return r.a.createElement(de.a,{item:!0},r.a.createElement("img",{className:je()(s.inputImg,Object(ye.a)({},s.inputImgActive,o)),src:n,onClick:function(){return t.setInput(a)}}))};xe=Object(le.withStyles)({inputImg:{width:"96px",height:"96px"},inputImgActive:{borderBottom:"3px rgb(53, 81, 181) solid"}})(xe);var ke=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.module.getInputs()}},{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(we.a,{className:t.inputsBar},r.a.createElement(de.a,{container:!0,direction:"row",justify:"center",alignItems:"center",wrap:"nowrap"},this.props.module.state.inputs.map(function(t,a){return r.a.createElement(xe,Object.assign({src:t,id:a},e.props,{key:a}))})))}}]),t}(n.Component);function Se(e){var t=e.module,a=e.classes;return r.a.createElement(te.a,{position:"fixed",className:a.appBar},r.a.createElement(ie.a,null,r.a.createElement(se.a,{variant:"h6",color:"inherit",noWrap:!0},"Mirror"),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(Ee.a,{mdUp:!0},r.a.createElement(ne.a,{color:"inherit",onClick:t.toogleDrawer},r.a.createElement(ge.a,null)))))}var Le=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={openSettings:!1},a.toggleSettings=function(){var e=!a.state.openSettings;a.setState({openSettings:e})},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(v.b,null,r.a.createElement(v.c,{to:[y]},function(a){return r.a.createElement("div",{className:t.root},r.a.createElement(Se,Object.assign({module:Se},e.props,{module:a})),r.a.createElement(P.a,{variant:"permanent",className:t.drawer,classes:{paper:t.drawerPaper}},r.a.createElement("div",{className:t.toolbar}),r.a.createElement(V,{module:a})),a.state.isLoading?r.a.createElement(ue.a,{color:"secondary",className:t.progress}):"",r.a.createElement("main",{className:t.content},r.a.createElement("div",{className:t.toolbar}),r.a.createElement(fe,{module:a,classes:t}),r.a.createElement(ke,{module:a,classes:t})),r.a.createElement(Ee.a,{smDown:!0},r.a.createElement(Z,{toogle:a.toogleDrawer,open:a.state.open,module:a,classes:t})),r.a.createElement(Ee.a,{mdUp:!0},r.a.createElement(Z,{toogle:a.toogleDrawer,open:a.state.open,module:a,classes:t,small:!0})))}))}}]),t}(n.Component),Ie=Object(le.withStyles)(function(e){return{root:{flexGrow:1,display:"flex",flexDirection:"row",minHeight:"100vh"},typography:{useNextVariants:!0},appBar:{zIndex:e.zIndex.drawer+1},drawer:{width:300,flexShrink:0},drawerPaper:{flexShrink:0,width:300},content:{flexGrow:1,backgroundColor:e.palette.background.default,padding:3*e.spacing.unit,marginBottom:"102px"},toolbar:e.mixins.toolbar,progress:{position:"fixed",top:"0",width:"100vw",zIndex:9999},settings:{width:"300px !important"},sliders:{width:"200px !important"},layersOuput:{},inputsBar:{position:"fixed",bottom:0,width:"100%",left:0,overflowY:"scroll"}}})(Le);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Ie,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[215,2,1]]]);
//# sourceMappingURL=main.e85ab74f.chunk.js.map