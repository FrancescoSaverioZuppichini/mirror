(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{122:function(e,t,a){e.exports=a(310)},127:function(e,t,a){},129:function(e,t,a){},310:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(20),o=a.n(s),i=(a(127),a(14)),l=a(15),c=a(18),u=a(16),p=a(17),m=(a(129),a(120)),d=a(21),h=a.n(d),g=a(30),v=a(33),f=a(44),E=a.n(f),b={GET_MODULE:"/api/model",GET_VISUALISATIONS:"/api/visualisation",PUT_VISUALISATIONS:"/api/visualisation",getModuleLayerOutput:function(e){return"/api/model/layer/output/".concat(e)}},O=(a(154),function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={tree:null,visualisations:[],currentVisualisation:{},isLoading:!1,open:!1,outputs:[],layer:{name:""},last:0,next:!1,settings:{size:50}},a.toogleDrawer=Object(g.a)(h.a.mark(function e(){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({open:!a.state.open});case 2:case"end":return e.stop()}},e,this)})),a.getLayerOutputs=Object(g.a)(h.a.mark(function e(){var t,n,r,s,o,i,l=arguments;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:a.state.layer,n=l.length>1&&void 0!==l[1]&&l[1],!a.state.isLoading){e.next=5;break}return console.log("Loading"),e.abrupt("return");case 5:return r=t.id==a.state.layer.id,n&&(r=!1),s=r?a.state.last+64:0,e.prev=8,e.next=11,a.setState({isLoading:!0});case 11:return e.next=13,E.a.get(b.getModuleLayerOutput(t.id,s),{params:{last:s}});case 13:return o=e.sent,i=r?a.state.outputs.concat(o.data.links):o.data.links,e.next=17,a.setState({outputs:i,layer:t,last:s,isLoading:!1,next:o.data.next});case 17:e.next=23;break;case 19:return e.prev=19,e.t0=e.catch(8),e.next=23,a.setState({isLoading:!1});case 23:case"end":return e.stop()}},e,this,[[8,19]])})),a.changeSettings=function(){var e=Object(g.a)(h.a.mark(function e(t){return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.setState({settings:t});case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"getTree",value:function(){var e=Object(g.a)(h.a.mark(function e(){var t,a;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({isLoading:!0});case 2:return e.next=4,E.a.get(b.GET_MODULE);case 4:return t=e.sent,a=t.data,e.next=8,this.setState({tree:a,isLoading:!1});case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getVisualisations",value:function(){var e=Object(g.a)(h.a.mark(function e(){var t,a,n;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.isLoading){e.next=3;break}return console.log("Loading"),e.abrupt("return");case 3:return e.next=5,this.setState({isLoading:!0});case 5:return e.next=7,E.a.get(b.GET_VISUALISATIONS);case 7:return t=e.sent,a=t.data.visualisations,n=t.data.current,e.next=12,this.setState({visualisations:a,isLoading:!1,currentVisualisation:n});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setVisualisationsSettings",value:function(){var e=Object(g.a)(h.a.mark(function e(t){var a,n,r,s;return h.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("PORCODIO"),!this.state.isLoading){e.next=4;break}return console.log("Loading"),e.abrupt("return");case 4:return e.next=6,this.setState({isLoading:!0});case 6:return e.next=8,E.a.put(b.PUT_VISUALISATIONS,t);case 8:for(s in a=e.sent,n=a.data,r=Object(m.a)(this.state.visualisations))r[s].name==n.name&&(r[s]=n);return e.next=14,this.setState({isLoading:!1,currentVisualisation:n,visualisations:r});case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),t}(v.a)),y=a(23),w=a.n(y),j=a(24),x=a.n(j),k=a(26),S=a.n(k),L=a(112),C=a.n(L),I=a(110),N=a.n(I),A=a(111),V=a.n(A),M=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={open:!1},a.getMoreOnScrollBottom=function(){var e=a.props.module.state.layerId==a.props.layer.id;window.scrollY==window.scrollMaxY&&e&&!a.props.module.state.isLoading&&a.props.module.getLayerOutputs(a.props.layer.id)},a.handleClick=function(e){a.setState(function(e){return{open:!e.open}}),a.props.module.getLayerOutputs(e)},a.renderLayer=function(e){var n=a.props.layer.name.split("(")[0];return r.a.createElement(w.a,null,r.a.createElement(x.a,{button:!0,onClick:function(){return a.handleClick(a.props.layer)}},r.a.createElement(S.a,{primary:n}),a.state.open?r.a.createElement(N.a,null):r.a.createElement(V.a,null)),r.a.createElement(C.a,{in:a.state.open,timeout:"auto",unmountOnExit:!0},e.children.map(function(e,n){return r.a.createElement(t,{layer:e,module:a.props.module,key:n,deepth:a.props.deepth+1})})))},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){window.addEventListener("scroll",this.getMoreOnScrollBottom)}},{key:"componentWillUnmount",value:function(){window.addEventListener("scroll",this.getMoreOnScrollBottom)}},{key:"render",value:function(){var e=this.props.layer;return r.a.createElement(w.a,{style:{marginLeft:8*this.props.deepth/2}},e?this.renderLayer(e):r.a.createElement(x.a,null))}}]),t}(n.Component),T=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.module.getTree()}},{key:"render",value:function(){var e=this.props.module.state.tree;return r.a.createElement(w.a,null,r.a.createElement(M,{layer:e,module:this.props.module,deepth:1}))}}]),t}(n.Component),D=a(27),U=a(58),z=a.n(U),B=a(56),P=a.n(B),G=a(75),_=a.n(G),W=a(113),J=a(57),Y=a.n(J),H=a(114),R=a.n(H),$=a(115),q=a.n($),F=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(s)))).state={anchorEl:null},a.handleMenuClick=function(e){a.setState({anchorEl:e.currentTarget})},a.handleClose=function(e,t){a.setState({anchorEl:null}),a.update(Object(D.a)({},e,{value:t}))},a.update=function(e){var t=Object(D.a)({},a.props.param,e),n={};n[a.props.name]=t,a.props.update(n)},a.makeParam=function(e){if("slider"==e.type){var t=e.max,n=e.min,s=e.step,o=e.value;return r.a.createElement(S.a,null,r.a.createElement("div",null,a.props.name+" : "+o),r.a.createElement("div",{className:a.props.classes.sliders},r.a.createElement(P.a,{value:o,"aria-labelledby":"label",min:n,max:t,step:s,onChange:Object(W.a)(300,function(t,n){return a.update(Object(D.a)({},e,{value:n}))})})))}if("radio"==e.type)return r.a.createElement(S.a,null,r.a.createElement("div",null,a.props.name,r.a.createElement(_.a,{checked:e.value,onClick:function(t,n){return a.update(Object(D.a)({},e,{value:!e.value}))},value:"a",name:"radio-button-demo","aria-label":"A"})));if("menu"==e.type){var i=e.items,l=(o=e.value,a.state.anchorEl);return r.a.createElement(S.a,null,r.a.createElement("div",null,a.props.name,r.a.createElement(Y.a,{"aria-owns":l?"".concat(a.props.name,"-menu"):void 0,"aria-haspopup":"true",onClick:a.handleMenuClick},o),r.a.createElement(R.a,{id:"".concat(a.props.name,"-menu"),anchorEl:l,open:Boolean(l),onClose:a.handleClose},i.map(function(t){return r.a.createElement(q.a,{onClick:function(){return a.handleClose(e,t)}},t)}))))}},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=(e.classes,e.module,e.param);e.name,t.params;return r.a.createElement(w.a,null,r.a.createElement(x.a,null,this.makeParam(t)),r.a.createElement(x.a,null))}}]),t}(n.Component),K=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).update=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(console.log("from down",e),t){var n=Object(D.a)({},a.props.visualisation.params,e);n=Object(D.a)({},a.props.visualisation,{params:n})}else n=Object(D.a)({},a.props.visualisation,e);console.log(n),a.props.module.setVisualisationsSettings(n),a.props.module.getLayerOutputs(a.props.module.state.layer,!0)},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=(t.module,t.visualisation),n=a.name,s=a.params;return r.a.createElement(w.a,null,r.a.createElement(x.a,null,r.a.createElement(S.a,null,r.a.createElement("div",null,n)),r.a.createElement(_.a,{checked:this.props.module.state.currentVisualisation.name==n,onChange:function(t,n){return e.update(Object(D.a)({},a,{value:n}),!1)},value:"a",name:"radio-button-demo","aria-label":"A"})),Object.keys(s).map(function(t,a){return r.a.createElement(F,Object.assign({},e.props,{name:t,param:s[t],update:e.update,key:a}))}))}}]),t}(n.Component),Q=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).onVisualisationSettingsChange=function(e){a.props.module.setVisualisationsSettings(e)},a.handleSlider=function(e,t){var n=a.props.module,r=n.state.settings;r=Object.assign({},r,{size:t}),n.changeSettings(r)},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.module.getVisualisations()}},{key:"render",value:function(){var e=this,t=this.props,a=t.toogle,n=t.classes,s=t.open,o=t.module,i=t.small,l=void 0!==i&&i;return r.a.createElement(z.a,{anchor:"right",variant:l?"temporary":"permanent",open:s,className:n.drawer,onClose:a,classes:{paper:n.drawerPaper}},r.a.createElement("div",{className:n.toolbar}),r.a.createElement(w.a,{className:n.settings},r.a.createElement(x.a,null,r.a.createElement(S.a,null,"Image size : ",o.state.settings.size)),r.a.createElement(x.a,null,r.a.createElement(P.a,{value:o.state.settings.size,"aria-labelledby":"label",min:1,max:100,step:1,onChange:this.handleSlider}))),r.a.createElement(w.a,{className:n.settings},r.a.createElement(x.a,null,r.a.createElement(S.a,null,r.a.createElement("div",null,"Visualisations"),this.props.module.state.visualisations.map(function(t,a){return r.a.createElement(K,Object.assign({key:a},e.props,{visualisation:t,update:e.onVisualisationSettingsChange}))})))))}}]),t}(n.Component),X=a(116),Z=a.n(X),ee=a(74),te=a.n(ee),ae=a(42),ne=a.n(ae),re=a(117),se=a.n(re),oe=a(55),ie=a(119),le=a.n(ie),ce=a(43),ue=a(29),pe=a.n(ue),me=(n.Component,function(e){var t=e.src,a=e.size,n={height:"".concat(a/10*100,"px"),width:"".concat(a/10*100,"px")};return r.a.createElement(pe.a,{item:!0},r.a.createElement("img",{src:t,style:n}))}),de=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.module;e.classes;return r.a.createElement("div",null,r.a.createElement(pe.a,{container:!0,direction:"row",justify:"center",alignItems:"center",spacing:8},r.a.createElement(pe.a,{item:!0,xs:12},r.a.createElement(ne.a,{variant:"h6",gutterBottom:!0,style:{textAlign:"center"}},t.state.layer.name.split("(")[0])),t.state.outputs.map(function(e,a){return r.a.createElement(me,Object.assign({src:e},t.state.settings,{key:a}))})),r.a.createElement(pe.a,{container:!0,direction:"row",justify:"center",alignItems:"center",spacing:8},r.a.createElement(pe.a,{item:!0},0==this.props.module.state.outputs.length?r.a.createElement("h1",null,"Nothing to show"):this.props.module.state.next?r.a.createElement(Y.a,{variant:"contained",color:"primary",onClick:function(){return t.getLayerOutputs()}},"More"):"")))}}]),t}(r.a.Component),he=a(118),ge=a.n(he),ve=a(59),fe=a.n(ve);function Ee(e){var t=e.module,a=e.classes;return r.a.createElement(Z.a,{position:"fixed",className:a.appBar},r.a.createElement(se.a,null,r.a.createElement(ne.a,{variant:"h6",color:"inherit",noWrap:!0},"Mirror"),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(fe.a,{mdUp:!0},r.a.createElement(te.a,{color:"inherit",onClick:t.toogleDrawer},r.a.createElement(ge.a,null)))))}var be=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={openSettings:!1},a.toggleSettings=function(){var e=!a.state.openSettings;a.setState({openSettings:e})},a}return Object(p.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.classes;return r.a.createElement(v.b,null,r.a.createElement(v.c,{to:[O]},function(a){return r.a.createElement("div",{className:t.root},r.a.createElement(Ee,Object.assign({module:Ee},e.props,{module:a})),r.a.createElement(z.a,{variant:"permanent",className:t.drawer,classes:{paper:t.drawerPaper}},r.a.createElement("div",{className:t.toolbar}),r.a.createElement(T,{module:a})),a.state.isLoading?r.a.createElement(le.a,{color:"secondary",className:t.progress}):"",r.a.createElement("main",{className:t.content},r.a.createElement("div",{className:t.toolbar}),r.a.createElement(de,{module:a,classes:t})),r.a.createElement(fe.a,{smDown:!0},r.a.createElement(Q,{toogle:a.toogleDrawer,open:a.state.open,module:a,classes:t})),r.a.createElement(fe.a,{mdUp:!0},r.a.createElement(Q,{toogle:a.toogleDrawer,open:a.state.open,module:a,classes:t,small:!0})))}))}}]),t}(n.Component),Oe=Object(oe.withStyles)(function(e){return{root:{flexGrow:1,display:"flex",flexDirection:"row",minHeight:"100vh"},typography:{useNextVariants:!0},appBar:{zIndex:e.zIndex.drawer+1},drawer:{width:300,flexShrink:0},drawerPaper:{flexShrink:0,width:300},content:{flexGrow:1,backgroundColor:e.palette.background.default,padding:3*e.spacing.unit},toolbar:e.mixins.toolbar,progress:{position:"fixed",top:"0",width:"100vw",zIndex:9999},settings:{width:"300px !important"},sliders:{width:"200px !important"},layersOuput:{}}})(be);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(Oe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[122,2,1]]]);
//# sourceMappingURL=main.0f5f7818.chunk.js.map